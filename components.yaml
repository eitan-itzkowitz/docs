---
components:
  schemas:
    # ENTITY TYPE
    EntityType:
      type: string
      title: EntityType
      description: >-
        The legal entity type of the company, impacting tax reporting and
        compliance.
      enum:
        - cCorp
        - llc
        - partnership
        - sCorp
        - soleProprietorship
        - professionalServiceCorporation

    # INDUSTRY
    Industry:
      type: string
      title: Industry
      description: >-
        Represents the industry or sector the company operates in.
      enum:
        - realEstate
        - restaurant
        - healthcare
        - other
        - consumerOnPremise
        - retail
        - professionalServices
        - homeServices
        - legal
        - saas
        - manufacturing
        - shortTermRental
        - construction
        - transportation
        - ecommerce
        - finance

    # CONTRACT TERMS (NEW)
    ContractTerms:
      type: object
      title: ContractTerms
      description: >-
        Defines contract-related terms associated with a billing model.
      properties:
        contractLengthMonths:
          type: integer
          description: >-
            Duration of the contract in months.
          example: 12
        paymentTerms:
          type: string
          description: >-
            Payment terms associated with the billing type.
          enum:
            - prepaid
            - postpaid
        autoRenewal:
          type: boolean
          description: >-
            Whether the contract auto-renews at the end of the term.
          example: true
        cancellationPolicy:
          type: string
          description: >-
            Policy regarding contract cancellation.
          example: "Requires 30 days' notice for termination."

    # BILLING MODEL
    BillingModel:
      type: array
      title: BillingModel
      description: >-
        Represents the types of billing structures a company can have.
      items:
        type: string
        enum:
          - annualSubscription
          - monthlySubscription
          - addOns
          - hourlyBilling
          - transactionBased
          - usageBased
          - other
          - fixedFee

    # MONETARY VALUE
    MonetaryValue:
      type: object
      title: MonetaryValue
      description: >-
        A standardized format for monetary values, including amount and
        currency.
      required:
        - amount
        - currency
      properties:
        amount:
          type: number
          format: double
          description: >-
            The monetary amount, formatted as a numeric value with up to two
            decimal places. Negative values represent credits or refunds.
          examples:
            - 1234.56
            - -500
        currency:
          type: string
          description: >-
            The currency used, following the ISO 4217 standard (e.g., USD, EUR, GBP).
          pattern: '^[A-Z]{3}$'
          examples:
            - USD
            - EUR

    # COMPANY
    Company:
      type: object
      title: Company
      description: >-
        The Company model represents businesses using the platform. It includes
        legal, industry, billing, and operational details.
      required:
        - id
        - vertical
        - billingTypes
        - entityType
        - legalName
        - timeZone
        - address
      properties:
        id:
          type: string
          description: >-
            A unique identifier for the company, auto-generated by the system.
        vertical:
          $ref: "#/components/schemas/Industry"
          description: >-
            Represents the industry or sector the company operates in.
            - realEstate
            - restaurant
            - healthcare
            - other
            - consumerOnPremise
            - retail
            - professionalServices
            - homeServices
            - legal
            - saas
            - manufacturing
            - shortTermRental
            - construction
            - transportation
            - ecommerce
            - finance
        billingTypes:
          $ref: "#/components/schemas/BillingModel"
          description: >-
            The types of billing plans associated with the company.
              - annualSubscription
              - monthlySubscription
              - addOns
              - hourlyBilling
              - transactionBased
              - usageBased
              - other
              - fixedFee
        entityType:
          $ref: "#/components/schemas/EntityType"
          description: >-
            The legal entity type of the company, impacting tax reporting and compliance.
            - C_Corp
            - LLC
            - Partnership
            - S_Corp
            - Sole_Proprietorship
            - Professional_Service_Corporation
        legalName:
          type: string
          description: >-
            The company’s registered legal name.
        dba:
          type: string
          description: >-
            The company’s "doing business as" name, if different from the legal name.
        timeZone:
          type: string
          description: >-
            The company’s primary timezone, used for scheduling and reporting purposes.
        email:
          type: string
          description: >-
            The company’s primary email address for correspondence.
        accountingFirm:
          type: string
          description: >-
            The name of the accounting firm associated with the company, if applicable.
        hasHistoricalData:
          type: boolean
          description: >-
            Indicates whether the company has historical financial data. Defaults to `false` if left blank.
        phoneNumber:
          type: string
          description: >-
            The company’s primary phone number.
        address:
          $ref: "#/components/schemas/Address"
          description: >-
            A reference to the Address model for the company’s address details.
        website:
          type: string
          description: >-
            The company’s website URL.
        partnerReferrer:
          type: string
          description: >-
            Identifies how the company was referred to the platform.

    # TAX RATE
    TaxRate:
      type: object
      title: TaxRate
      description: >-
        The Tax Rate model documents tax configurations for a company.
        It provides details about tax rates, including their type, jurisdiction,
        calculation method, and parameters.

        **Effective Date Rules:**
        - If no `effectiveDate` is set, the tax rate is assumed to be effective as of `createdAt`.
        - If multiple tax rates have overlapping `effectiveDate` ranges, all applicable rates will be considered.
        - If `effectiveDate` is in the future, the tax rate will not be applied until that date.
        - Effective date ranges are inclusive of both start and end bounds.
        - If a tax rate is superseded by another, the superseding rate takes precedence.
      required:
        - id
        - createdAt
        - company
        - displayName
        - jurisdictionType
        - jurisdictionName
        - calculationType
      properties:
        company:
          $ref: "#/components/schemas/Company"
          description: >-
            A reference to the company associated with this tax rate.

    # COMPANY
    Company:
      type: object
      title: Company
      description: >-
        Represents a company using the platform. Includes legal, financial, and operational details.
      required:
        - id
        - name
        - entityType
        - industry
      properties:
        id:
          type: string
          description: >-
            A unique identifier for the company.
        name:
          type: string
          description: >-
            The registered name of the company.
        entityType:
          $ref: "#/components/schemas/EntityType"
          description: >-
            The legal entity type of the company.
        industry:
          $ref: "#/components/schemas/Industry"
          description: >-
            The industry or sector in which the company operates.
        address:
          type: string
          description: >-
            The company’s primary business address.
        website:
          type: string
          description: >-
            The company’s official website.

    # FIRM
    Firm:
      type: object
      title: Firm
      description: >-
        Represents an external firm providing services to client companies, such as accounting, legal, or consulting firms.
      required:
        - id
        - name
        - industry
      properties:
        id:
          type: string
          description: >-
            A unique identifier for the firm.
        name:
          type: string
          description: >-
            The registered name of the firm.
        industry:
          type: string
          enum:
            - accounting
            - legal
            - payroll
            - consulting
            - generalBackOffice
          description: >-
            The industry or sector in which the firm operates.
        employees:
          type: array
          items:
            $ref: "#/components/schemas/User"
          description: >-
            Users affiliated with the firm.
        Represents an external firm providing services to client companies, such as accounting, legal, or consulting firms.
      required:
        - id
        - name
        - industry
      properties:
        id:
          type: string
          description: >-
            A unique identifier for the firm.
        name:
          type: string
          description: >-
            The registered name of the firm.
        industry:
          type: string
          enum:
            - accounting
            - legal
            - payroll
            - consulting
          description: >-
            The industry or sector in which the firm operates.
        employees:
          type: array
          items:
            $ref: "#/components/schemas/User"
          description: >-
            Users affiliated with the firm.

    # ROLE
    Role:
      type: object
      title: Role
      description: >-
        Defines a user's role within the system, categorizing their relationship to a company or firm.
      properties:
        roleType:
          type: string
          description: >-
            The user's relationship to the company or firm.
          enum:
            - owner
            - executive
            - employee
            - contractor
            - consultant
        function:
          type: string
          description: >-
            The primary area of expertise or responsibility for the user.
          enum:
            - accounting
            - finance
            - operations
            - technology
            - legal
            - admin

    # USER
    User:
      type: object
      title: User
      description: >-
        An individual with a credential in the system. Includes details about their role and affiliation.
      required:
        - id
        - name
        - email
        - createdAt
        - role
      properties:
        id:
          type: string
          description: >-
            A unique identifier for the user.
        name:
          type: string
          description: >-
            The full name of the user.
        email:
          type: string
          description: >-
            The email address associated with the user.
        createdAt:
          type: string
          format: date-time
          description: >-
            The date and time when the user was created.
        updatedAt:
          type: string
          format: date-time
          description: >-
            The date and time when the user was last updated.
        role:
          $ref: "#/components/schemas/Role"
          description: >-
            The user's role, defining their function and relationship to a company or firm.
        affiliatedWith:
          oneOf:
            - $ref: "#/components/schemas/Company"
            - $ref: "#/components/schemas/Firm"
          description: >-
            The entity the user is associated with, either a company or a firm.
